<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TechSupport Pro | Módulo de Facturas</title>
    
    <!-- Bootstrap 5 + Font Awesome -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Custom CSS -->
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <div class="container-fluid">
        <div class="row">
            <!-- Sidebar -->
            <div class="col-md-2 sidebar p-0">
                <div class="p-4">
                    <h4 class="text-white mb-4">
                        <i class="fas fa-tools me-2"></i>TechSupport Pro
                    </h4>
                    
                    <ul class="nav flex-column">
                        <li class="nav-item">
                            <a class="nav-link" href="index.html" id="nav-dashboard">
                                <i class="fas fa-chart-line"></i> Dashboard
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="soporte.html" id="nav-soporte">
                                <i class="fas fa-laptop-medical"></i> Soporte
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="cotizaciones.html" id="nav-cotizaciones">
                                <i class="fas fa-file-invoice-dollar"></i> Cotizaciones
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="facturas.html" id="nav-facturas">
                                <i class="fas fa-receipt"></i> Facturas
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="inventario.html" id="nav-inventario">
                                <i class="fas fa-boxes"></i> Inventario
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="directorio.html" id="nav-directorio">
                                <i class="fas fa-address-book"></i> Directorio
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="ajustes.html" id="nav-ajustes">
                                <i class="fas fa-cog"></i> Ajustes
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
            
            <!-- Main Content -->
            <div class="col-md-10 ms-auto p-4">
                <div class="row mb-4">
                    <div class="col-12">
                        <h4 class="fade-in"><i class="fas fa-receipt me-2"></i>Gestión de Facturas</h4>
                    </div>
                </div>

                <!-- Resumen de Facturas -->
                <div class="row mb-4">
                    <div class="col-md-3">
                        <div class="card card-support fade-in">
                            <div class="card-body">
                                <h6 class="text-muted">Facturas Totales</h6>
                                <h3>45</h3>
                                <div class="progress progress-custom">
                                    <div class="progress-bar progress-bar-custom bg-primary" style="width: 100%"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="card card-support fade-in">
                            <div class="card-body">
                                <h6 class="text-muted">Pendientes de Pago</h6>
                                <h3>12</h3>
                                <div class="progress progress-custom">
                                    <div class="progress-bar progress-bar-custom bg-warning" style="width: 27%"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="card card-support fade-in">
                            <div class="card-body">
                                <h6 class="text-muted">Pagadas</h6>
                                <h3>28</h3>
                                <div class="progress progress-custom">
                                    <div class="progress-bar progress-bar-custom bg-success" style="width: 62%"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="card card-support fade-in">
                            <div class="card-body">
                                <h6 class="text-muted">Vencidas</h6>
                                <h3>5</h3>
                                <div class="progress progress-custom">
                                    <div class="progress-bar progress-bar-custom bg-danger" style="width: 11%"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Tabla de Facturas -->
                <div class="card card-support fade-in mb-4">
                    <div class="card-header bg-white">
                        <div class="d-flex justify-content-between align-items-center mb-3">
                            <h5 class="mb-0">Lista de Facturas</h5>
                            <div class="d-flex gap-2">
                                <button class="btn btn-success btn-sm btn-custom" onclick="exportToExcel()">
                                    <i class="fas fa-file-excel me-1"></i>Exportar a Excel
                                </button>
                                <button class="btn btn-primary btn-sm btn-custom" onclick="printInvoices()">
                                    <i class="fas fa-print me-1"></i>Imprimir
                                </button>
                            </div>
                        </div>
                        <div class="search-container">
                            <div class="input-group">
                                <span class="input-group-text bg-white border-end-0">
                                    <i class="fas fa-search text-muted"></i>
                                </span>
                                <input type="text" 
                                       class="form-control form-control-custom border-start-0" 
                                       id="searchInvoice" 
                                       placeholder="Buscar por cliente, ID o estado..."
                                       onkeyup="searchTable()">
                            </div>
                            <div class="mt-2">
                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" type="checkbox" id="searchClient" checked>
                                    <label class="form-check-label" for="searchClient">Cliente</label>
                                </div>
                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" type="checkbox" id="searchId" checked>
                                    <label class="form-check-label" for="searchId">ID</label>
                                </div>
                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" type="checkbox" id="searchStatus" checked>
                                    <label class="form-check-label" for="searchStatus">Estado</label>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-custom" id="invoicesTable">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>Cliente</th>
                                        <th>Equipo</th>
                                        <th>Fecha Emisión</th>
                                        <th>Vencimiento</th>
                                        <th>Total</th>
                                        <th>Estado</th>
                                        <th>Acciones</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>#FAC001</td>
                                        <td>Ana Martínez</td>
                                        <td>HP Pavilion 15-dk1056wm</td>
                                        <td>20/03/2024</td>
                                        <td>20/04/2024</td>
                                        <td>$208.80</td>
                                        <td><span class="status-badge status-pendiente">Pendiente</span></td>
                                        <td>
                                            <div class="btn-group btn-group-sm">
                                                <button class="btn btn-info btn-custom" onclick="viewInvoice('FAC001')">
                                                    <i class="fas fa-eye"></i>
                                                </button>
                                                <button class="btn btn-success btn-custom" onclick="markAsPaid('FAC001')">
                                                    <i class="fas fa-check"></i>
                                                </button>
                                                <button class="btn btn-warning btn-custom" onclick="sendReminder('FAC001')">
                                                    <i class="fas fa-bell"></i>
                                                </button>
                                                <button class="btn btn-primary btn-custom" onclick="printInvoice('FAC001')">
                                                    <i class="fas fa-print"></i>
                                                </button>
                                            </div>
                                        </td>
                                    </tr>
                                    <!-- Más filas de ejemplo -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Ver Factura -->
    <div class="modal fade" id="viewInvoiceModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header bg-white">
                    <h5 class="mb-0">
                        <i class="fas fa-receipt me-2"></i>Factura #<span id="viewInvoiceId"></span>
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="row g-3">
                        <!-- Información de la Factura -->
                        <div class="col-12">
                            <div class="card">
                                <div class="card-header bg-light">
                                    <h6 class="mb-0">Información de la Factura</h6>
                                </div>
                                <div class="card-body">
                                    <div class="row">
                                        <div class="col-md-6">
                                            <dl class="row mb-0">
                                                <dt class="col-sm-4">Número:</dt>
                                                <dd class="col-sm-8" id="viewInvoiceNumber"></dd>
                                                <dt class="col-sm-4">Fecha Emisión:</dt>
                                                <dd class="col-sm-8" id="viewInvoiceDate"></dd>
                                                <dt class="col-sm-4">Vencimiento:</dt>
                                                <dd class="col-sm-8" id="viewInvoiceDueDate"></dd>
                                            </dl>
                                        </div>
                                        <div class="col-md-6">
                                            <dl class="row mb-0">
                                                <dt class="col-sm-4">Estado:</dt>
                                                <dd class="col-sm-8" id="viewInvoiceStatus"></dd>
                                                <dt class="col-sm-4">Método Pago:</dt>
                                                <dd class="col-sm-8" id="viewPaymentMethod"></dd>
                                            </dl>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Información del Cliente -->
                        <div class="col-md-6">
                            <div class="card">
                                <div class="card-header bg-light">
                                    <h6 class="mb-0">Información del Cliente</h6>
                                </div>
                                <div class="card-body">
                                    <dl class="row mb-0">
                                        <dt class="col-sm-4">Nombre:</dt>
                                        <dd class="col-sm-8" id="viewClientName"></dd>
                                        <dt class="col-sm-4">Teléfono:</dt>
                                        <dd class="col-sm-8" id="viewClientPhone"></dd>
                                        <dt class="col-sm-4">Correo:</dt>
                                        <dd class="col-sm-8" id="viewClientEmail"></dd>
                                        <dt class="col-sm-4">Dirección:</dt>
                                        <dd class="col-sm-8" id="viewClientAddress"></dd>
                                    </dl>
                                </div>
                            </div>
                        </div>

                        <!-- Información del Equipo -->
                        <div class="col-md-6">
                            <div class="card">
                                <div class="card-header bg-light">
                                    <h6 class="mb-0">Información del Equipo</h6>
                                </div>
                                <div class="card-body">
                                    <dl class="row mb-0">
                                        <dt class="col-sm-4">Marca:</dt>
                                        <dd class="col-sm-8" id="viewEquipmentBrand"></dd>
                                        <dt class="col-sm-4">Modelo:</dt>
                                        <dd class="col-sm-8" id="viewEquipmentModel"></dd>
                                        <dt class="col-sm-4">Serie:</dt>
                                        <dd class="col-sm-8" id="viewEquipmentSerial"></dd>
                                    </dl>
                                </div>
                            </div>
                        </div>

                        <!-- Detalles de la Factura -->
                        <div class="col-12">
                            <div class="card">
                                <div class="card-header bg-light">
                                    <h6 class="mb-0">Detalles de la Factura</h6>
                                </div>
                                <div class="card-body">
                                    <div class="table-responsive">
                                        <table class="table" id="viewInvoiceItemsTable">
                                            <thead>
                                                <tr>
                                                    <th>Descripción</th>
                                                    <th>Cantidad</th>
                                                    <th>Precio Unit.</th>
                                                    <th>Subtotal</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <!-- Los items se cargarán dinámicamente -->
                                            </tbody>
                                            <tfoot>
                                                <tr>
                                                    <td colspan="3" class="text-end">Subtotal:</td>
                                                    <td id="viewInvoiceSubtotal"></td>
                                                </tr>
                                                <tr>
                                                    <td colspan="3" class="text-end">IVA (16%):</td>
                                                    <td id="viewInvoiceTax"></td>
                                                </tr>
                                                <tr>
                                                    <td colspan="3" class="text-end fw-bold">Total:</td>
                                                    <td id="viewInvoiceTotal" class="fw-bold"></td>
                                                </tr>
                                            </tfoot>
                                        </table>
                                    </div>
                                    <div class="mt-3">
                                        <h6>Notas Adicionales:</h6>
                                        <p id="viewInvoiceNotes" class="mb-0"></p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer bg-light">
                    <button type="button" class="btn btn-secondary btn-custom" data-bs-dismiss="modal">Cerrar</button>
                    <button type="button" class="btn btn-success btn-custom" onclick="markAsPaid()">
                        <i class="fas fa-check me-2"></i>Marcar como Pagada
                    </button>
                    <button type="button" class="btn btn-warning btn-custom" onclick="sendReminder()">
                        <i class="fas fa-bell me-2"></i>Enviar Recordatorio
                    </button>
                    <button type="button" class="btn btn-primary btn-custom" onclick="printInvoice()">
                        <i class="fas fa-print me-2"></i>Imprimir
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de Pago -->
    <div class="modal fade" id="paymentModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header bg-white">
                    <h5 class="mb-0">
                        <i class="fas fa-money-bill-wave me-2"></i>Registrar Pago
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="paymentForm">
                        <div class="mb-3">
                            <label class="form-label">Método de Pago</label>
                            <select class="form-select" id="paymentMethod" required>
                                <option value="">Seleccione un método</option>
                                <option value="efectivo">Efectivo</option>
                                <option value="transferencia">Transferencia Bancaria</option>
                                <option value="tarjeta">Tarjeta de Crédito/Débito</option>
                                <option value="otro">Otro</option>
                            </select>
                        </div>
                        <div class="mb-3" id="transferenciaFields" style="display: none;">
                            <label class="form-label">Referencia de Transferencia</label>
                            <input type="text" class="form-control" id="transferReference" placeholder="Ingrese el número de referencia">
                        </div>
                        <div class="mb-3" id="tarjetaFields" style="display: none;">
                            <label class="form-label">Últimos 4 dígitos de la tarjeta</label>
                            <input type="text" class="form-control" id="cardLastDigits" placeholder="XXXX" maxlength="4">
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Monto Pagado</label>
                            <div class="input-group">
                                <span class="input-group-text">$</span>
                                <input type="number" class="form-control" id="paymentAmount" step="0.01" required>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Fecha de Pago</label>
                            <input type="date" class="form-control" id="paymentDate" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Notas Adicionales</label>
                            <textarea class="form-control" id="paymentNotes" rows="2"></textarea>
                        </div>
                    </form>
                </div>
                <div class="modal-footer bg-light">
                    <button type="button" class="btn btn-secondary btn-custom" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-success btn-custom" onclick="confirmPayment()">
                        <i class="fas fa-check me-2"></i>Confirmar Pago
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Custom JS -->
    <script>
        // Función para buscar en la tabla
        function searchTable() {
            const searchInput = document.getElementById('searchInvoice').value.toLowerCase();
            const table = document.getElementById('invoicesTable');
            const rows = table.getElementsByTagName('tbody')[0].getElementsByTagName('tr');
            
            const searchClient = document.getElementById('searchClient').checked;
            const searchId = document.getElementById('searchId').checked;
            const searchStatus = document.getElementById('searchStatus').checked;

            for (let row of rows) {
                let found = false;

                // ID
                if (searchId) {
                    const id = row.cells[0].textContent.toLowerCase();
                    if (id.includes(searchInput)) {
                        found = true;
                        row.cells[0].innerHTML = highlightText(id, searchInput);
                    } else {
                        row.cells[0].innerHTML = id;
                    }
                }

                // Cliente
                if (searchClient) {
                    const client = row.cells[1].textContent.toLowerCase();
                    if (client.includes(searchInput)) {
                        found = true;
                        row.cells[1].innerHTML = highlightText(row.cells[1].textContent, searchInput);
                    } else {
                        row.cells[1].innerHTML = row.cells[1].textContent;
                    }
                }

                // Estado
                if (searchStatus) {
                    const status = row.cells[6].textContent.toLowerCase();
                    if (status.includes(searchInput)) {
                        found = true;
                        row.cells[6].innerHTML = highlightText(row.cells[6].textContent, searchInput);
                    } else {
                        row.cells[6].innerHTML = row.cells[6].textContent;
                    }
                }

                row.style.display = found || searchInput === '' ? '' : 'none';
            }
        }

        function highlightText(text, search) {
            if (search === '') return text;
            const regex = new RegExp(`(${search})`, 'gi');
            return text.replace(regex, '<span class="highlight">$1</span>');
        }

        // Función para ver una factura
        function viewInvoice(invoiceId) {
            // Aquí iría la lógica para cargar los datos de la factura
            document.getElementById('viewInvoiceId').textContent = invoiceId;
            document.getElementById('viewInvoiceNumber').textContent = invoiceId;
            document.getElementById('viewInvoiceDate').textContent = '20/03/2024';
            document.getElementById('viewInvoiceDueDate').textContent = '20/04/2024';
            document.getElementById('viewInvoiceStatus').innerHTML = '<span class="status-badge status-pendiente">Pendiente</span>';
            document.getElementById('viewPaymentMethod').textContent = 'Transferencia Bancaria';
            
            // Datos del cliente
            document.getElementById('viewClientName').textContent = 'Ana Martínez';
            document.getElementById('viewClientPhone').textContent = '+1234567890';
            document.getElementById('viewClientEmail').textContent = 'ana@email.com';
            document.getElementById('viewClientAddress').textContent = 'Av. Principal #123, Ciudad';
            
            // Datos del equipo
            document.getElementById('viewEquipmentBrand').textContent = 'HP';
            document.getElementById('viewEquipmentModel').textContent = 'Pavilion 15-dk1056wm';
            document.getElementById('viewEquipmentSerial').textContent = '5CD9876543';

            // Cargar items
            const tbody = document.querySelector('#viewInvoiceItemsTable tbody');
            tbody.innerHTML = `
                <tr>
                    <td>Diagnóstico y reparación de sistema de ventilación</td>
                    <td>1</td>
                    <td>$180.00</td>
                    <td>$180.00</td>
                </tr>
            `;

            // Actualizar totales
            document.getElementById('viewInvoiceSubtotal').textContent = '$180.00';
            document.getElementById('viewInvoiceTax').textContent = '$28.80';
            document.getElementById('viewInvoiceTotal').textContent = '$208.80';

            // Mostrar el modal
            const modal = new bootstrap.Modal(document.getElementById('viewInvoiceModal'));
            modal.show();
        }

        // Variables globales para el pago
        let currentInvoiceId = null;

        // Función para marcar como pagada
        function markAsPaid(invoiceId) {
            currentInvoiceId = invoiceId;
            
            // Obtener el monto total de la factura
            const rows = document.querySelectorAll('#invoicesTable tbody tr');
            let total = '0.00';
            
            for (let row of rows) {
                const idCell = row.cells[0];
                if (idCell && idCell.textContent.includes(invoiceId)) {
                    const totalCell = row.cells[5]; // La columna del total
                    total = totalCell ? totalCell.textContent.replace('$', '') : '0.00';
                    break;
                }
            }
            
            // Establecer el monto por defecto
            document.getElementById('paymentAmount').value = total;
            
            // Establecer la fecha actual por defecto
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('paymentDate').value = today;
            
            // Limpiar campos específicos
            document.getElementById('transferReference').value = '';
            document.getElementById('cardLastDigits').value = '';
            document.getElementById('paymentNotes').value = '';
            document.getElementById('paymentMethod').value = '';
            
            // Ocultar campos específicos
            document.getElementById('transferenciaFields').style.display = 'none';
            document.getElementById('tarjetaFields').style.display = 'none';
            
            // Agregar clase de desenfoque a la sección principal
            document.querySelector('.col-md-10').classList.add('blur-background');
            
            // Mostrar el modal de pago
            const paymentModal = new bootstrap.Modal(document.getElementById('paymentModal'));
            paymentModal.show();
        }

        // Agregar evento para remover el desenfoque cuando se cierra el modal
        document.getElementById('paymentModal').addEventListener('hidden.bs.modal', function () {
            document.querySelector('.col-md-10').classList.remove('blur-background');
        });

        // Función para mostrar/ocultar campos según el método de pago
        document.getElementById('paymentMethod').addEventListener('change', function() {
            const transferenciaFields = document.getElementById('transferenciaFields');
            const tarjetaFields = document.getElementById('tarjetaFields');
            
            transferenciaFields.style.display = 'none';
            tarjetaFields.style.display = 'none';
            
            if (this.value === 'transferencia') {
                transferenciaFields.style.display = 'block';
            } else if (this.value === 'tarjeta') {
                tarjetaFields.style.display = 'block';
            }
        });

        // Función para confirmar el pago
        function confirmPayment() {
            const form = document.getElementById('paymentForm');
            if (!form.checkValidity()) {
                form.reportValidity();
                return;
            }

            const paymentMethod = document.getElementById('paymentMethod').value;
            const paymentAmount = document.getElementById('paymentAmount').value;
            const paymentDate = document.getElementById('paymentDate').value;
            const paymentNotes = document.getElementById('paymentNotes').value;
            
            let additionalInfo = '';
            if (paymentMethod === 'transferencia') {
                additionalInfo = `Referencia: ${document.getElementById('transferReference').value}`;
            } else if (paymentMethod === 'tarjeta') {
                additionalInfo = `Últimos 4 dígitos: ${document.getElementById('cardLastDigits').value}`;
            }

            // Aquí iría la lógica para guardar el pago
            alert(`Pago registrado para la factura #${currentInvoiceId}\nMétodo: ${paymentMethod}\nMonto: $${paymentAmount}\nFecha: ${paymentDate}\n${additionalInfo}\nNotas: ${paymentNotes}`);
            
            // Cerrar el modal
            const modal = bootstrap.Modal.getInstance(document.getElementById('paymentModal'));
            modal.hide();
            
            // Limpiar el formulario
            form.reset();
        }

        // Función para enviar recordatorio
        function sendReminder(invoiceId) {
            if (confirm(`¿Deseas enviar un recordatorio de pago para la factura #${invoiceId}?`)) {
                // Aquí iría la lógica para enviar el recordatorio
                alert(`Recordatorio enviado para la factura #${invoiceId}`);
            }
        }

        // Función para imprimir una factura
        function printInvoice(invoiceId) {
            // Aquí iría la lógica para imprimir la factura
            window.print();
        }

        // Función para exportar a Excel
        function exportToExcel() {
            // Aquí iría la lógica para exportar a Excel
            alert('Exportando a Excel...');
        }

        // Función para imprimir todas las facturas
        function printInvoices() {
            // Aquí iría la lógica para imprimir todas las facturas
            window.print();
        }
    </script>
// Agregar este script en todos los archivos HTML
<script>
// Función para manejar la navegación activa
function setActiveNavItem() {
    // Obtener el nombre del archivo actual
    const currentPage = window.location.pathname.split('/').pop() || 'index.html';
    
    // Remover la clase active de todos los enlaces
    document.querySelectorAll('.nav-link').forEach(link => {
        link.classList.remove('active');
    });
    
    // Agregar la clase active al enlace correspondiente
    let navId = '';
    switch(currentPage) {
        case 'index.html':
            navId = 'nav-dashboard';
            break;
        case 'soporte.html':
            navId = 'nav-soporte';
            break;
        case 'cotizaciones.html':
            navId = 'nav-cotizaciones';
            break;
        case 'facturas.html':
            navId = 'nav-facturas';
            break;
        case 'inventario.html':
            navId = 'nav-inventario';
            break;
        case 'directorio.html':
            navId = 'nav-directorio';
            break;
        case 'ajustes.html':
            navId = 'nav-ajustes';
            break;
    }
    
    const activeLink = document.getElementById(navId);
    if (activeLink) {
        activeLink.classList.add('active');
    }
}

// Agregar estos estilos para el menú
document.head.insertAdjacentHTML('beforeend', `
    <style>
        .sidebar {
            background-color: #2c3e50;
            min-height: 100vh;
            position: fixed;
            top: 0;
            left: 0;
            z-index: 100;
        }
        
        .nav-link {
            color: rgba(255,255,255,0.7);
            padding: 0.8rem 1rem;
            margin-bottom: 0.2rem;
            border-radius: 0.3rem;
            transition: all 0.3s ease;
        }
        
        .nav-link:hover {
            color: white;
            background-color: rgba(255,255,255,0.1);
            transform: translateX(5px);
        }
        
        .nav-link.active {
            color: white;
            background-color: rgba(255,255,255,0.2);
        }
        
        .nav-link i {
            width: 20px;
            margin-right: 10px;
            text-align: center;
        }
        
        /* Ajuste para el contenido principal */
        .main-content {
            margin-left: 16.666667%; /* col-md-2 */
        }
    </style>
`);

// Ejecutar cuando el DOM esté cargado
document.addEventListener('DOMContentLoaded', setActiveNavItem);

// Manejar el estado del tema oscuro
function loadThemePreference() {
    const darkMode = localStorage.getItem('darkMode') === 'true';
    document.body.classList.toggle('dark-mode', darkMode);
}

// Cargar preferencia de tema al inicio
loadThemePreference();
</script>
    <style>
    .search-container {
        background: #f8f9fa;
        padding: 15px;
        border-radius: 8px;
        margin-top: 10px;
    }

    .form-check-input:checked {
        background-color: #0d6efd;
        border-color: #0d6efd;
    }

    .highlight {
        background-color: #fff3cd;
        padding: 2px;
        border-radius: 3px;
    }

    .status-badge {
        padding: 5px 10px;
        border-radius: 15px;
        font-size: 0.85em;
        font-weight: 500;
    }

    .status-pendiente {
        background-color: #fff3cd;
        color: #856404;
    }

    .status-pagada {
        background-color: #d4edda;
        color: #155724;
    }

    .status-vencida {
        background-color: #f8d7da;
        color: #721c24;
    }

    /* Estilos para el modal de pago */
    .modal-backdrop.show {
        opacity: 0.85;
        background: linear-gradient(135deg, #000000 0%, #1a1a1a 100%);
    }

    /* Efecto de desenfoque para la sección de facturas */
    .blur-background {
        filter: blur(5px);
        -webkit-filter: blur(5px);
        transition: filter 0.3s ease-in-out;
    }

    #paymentModal .modal-content {
        border: none;
        box-shadow: 0 0 20px rgba(0, 0, 0, 0.3);
    }

    #paymentModal .modal-header {
        background: linear-gradient(135deg, #2c3e50 0%, #3498db 100%);
        color: white;
        border-bottom: none;
    }

    #paymentModal .modal-header .btn-close {
        filter: brightness(0) invert(1);
    }

    #paymentModal .modal-body {
        background-color: #f8f9fa;
    }

    #paymentModal .modal-footer {
        background: linear-gradient(135deg, #2c3e50 0%, #3498db 100%);
        border-top: none;
    }

    #paymentModal .form-label {
        font-weight: 500;
        color: #2c3e50;
    }

    #paymentModal .form-control,
    #paymentModal .form-select {
        border: 1px solid #dee2e6;
        border-radius: 8px;
        padding: 0.5rem 1rem;
    }

    #paymentModal .form-control:focus,
    #paymentModal .form-select:focus {
        border-color: #3498db;
        box-shadow: 0 0 0 0.2rem rgba(52, 152, 219, 0.25);
    }

    #paymentModal .btn-custom {
        border-radius: 8px;
        padding: 0.5rem 1.5rem;
        font-weight: 500;
    }

    #paymentModal .btn-success {
        background: linear-gradient(135deg, #27ae60 0%, #2ecc71 100%);
        border: none;
    }

    #paymentModal .btn-secondary {
        background: linear-gradient(135deg, #7f8c8d 0%, #95a5a6 100%);
        border: none;
    }

    @media print {
        .sidebar, .btn-group, .search-container {
            display: none !important;
        }
        
        .card {
            border: none !important;
        }
        
        .card-header {
            background-color: white !important;
        }
    }
    </style>
</body>
</html>
